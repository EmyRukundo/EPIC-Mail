'use strict';var cov_1zkuhj9l46=function(){var path="C:\\Users\\Admin\\Desktop\\mail\\EPIC-Mail\\server\\controllers\\message.js";var hash="5316e259a9b284ed6864bbf21f5924dcfd85ef84";var Function=function(){}.constructor;var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\Admin\\Desktop\\mail\\EPIC-Mail\\server\\controllers\\message.js",statementMap:{"0":{start:{line:3,column:0},end:{line:5,column:3}},"1":{start:{line:7,column:12},end:{line:23,column:2}},"2":{start:{line:25,column:18},end:{line:29,column:1}},"3":{start:{line:27,column:4},end:{line:27,column:20}},"4":{start:{line:28,column:4},end:{line:28,column:79}},"5":{start:{line:28,column:22},end:{line:28,column:79}},"6":{start:{line:31,column:20},end:{line:45,column:1}},"7":{start:{line:33,column:21},end:{line:42,column:5}},"8":{start:{line:43,column:4},end:{line:43,column:27}},"9":{start:{line:44,column:4},end:{line:44,column:25}},"10":{start:{line:47,column:20},end:{line:55,column:1}},"11":{start:{line:49,column:26},end:{line:51,column:6}},"12":{start:{line:50,column:8},end:{line:50,column:48}},"13":{start:{line:52,column:4},end:{line:52,column:99}},"14":{start:{line:52,column:26},end:{line:52,column:99}},"15":{start:{line:54,column:4},end:{line:54,column:42}},"16":{start:{line:57,column:18},end:{line:63,column:1}},"17":{start:{line:58,column:20},end:{line:60,column:6}},"18":{start:{line:59,column:8},end:{line:59,column:46}},"19":{start:{line:61,column:4},end:{line:61,column:71}},"20":{start:{line:61,column:20},end:{line:61,column:71}},"21":{start:{line:62,column:4},end:{line:62,column:36}},"22":{start:{line:65,column:20},end:{line:73,column:1}},"23":{start:{line:67,column:22},end:{line:69,column:6}},"24":{start:{line:68,column:8},end:{line:68,column:46}},"25":{start:{line:70,column:4},end:{line:70,column:73}},"26":{start:{line:70,column:22},end:{line:70,column:73}},"27":{start:{line:72,column:4},end:{line:72,column:38}},"28":{start:{line:75,column:18},end:{line:84,column:1}},"29":{start:{line:77,column:24},end:{line:79,column:6}},"30":{start:{line:78,column:8},end:{line:78,column:48}},"31":{start:{line:80,column:4},end:{line:80,column:90}},"32":{start:{line:80,column:24},end:{line:80,column:90}},"33":{start:{line:81,column:16},end:{line:81,column:42}},"34":{start:{line:82,column:4},end:{line:82,column:27}},"35":{start:{line:83,column:4},end:{line:83,column:91}},"36":{start:{line:86,column:0},end:{line:86,column:34}},"37":{start:{line:87,column:0},end:{line:87,column:38}},"38":{start:{line:88,column:0},end:{line:88,column:38}},"39":{start:{line:89,column:0},end:{line:89,column:34}},"40":{start:{line:90,column:0},end:{line:90,column:38}},"41":{start:{line:91,column:0},end:{line:91,column:34}}},fnMap:{"0":{name:"getMessages",decl:{start:{line:25,column:27},end:{line:25,column:38}},loc:{start:{line:25,column:49},end:{line:29,column:1}},line:25},"1":{name:"createMessage",decl:{start:{line:31,column:29},end:{line:31,column:42}},loc:{start:{line:31,column:53},end:{line:45,column:1}},line:31},"2":{name:"specificEmail",decl:{start:{line:47,column:29},end:{line:47,column:42}},loc:{start:{line:47,column:53},end:{line:55,column:1}},line:47},"3":{name:"(anonymous_3)",decl:{start:{line:49,column:37},end:{line:49,column:38}},loc:{start:{line:49,column:50},end:{line:51,column:5}},line:49},"4":{name:"sentMessage",decl:{start:{line:57,column:27},end:{line:57,column:38}},loc:{start:{line:57,column:49},end:{line:63,column:1}},line:57},"5":{name:"(anonymous_5)",decl:{start:{line:58,column:31},end:{line:58,column:32}},loc:{start:{line:58,column:44},end:{line:60,column:5}},line:58},"6":{name:"unreadMessage",decl:{start:{line:65,column:29},end:{line:65,column:42}},loc:{start:{line:65,column:53},end:{line:73,column:1}},line:65},"7":{name:"(anonymous_7)",decl:{start:{line:67,column:33},end:{line:67,column:34}},loc:{start:{line:67,column:46},end:{line:69,column:5}},line:67},"8":{name:"deleteEmail",decl:{start:{line:75,column:27},end:{line:75,column:38}},loc:{start:{line:75,column:49},end:{line:84,column:1}},line:75},"9":{name:"(anonymous_9)",decl:{start:{line:77,column:35},end:{line:77,column:36}},loc:{start:{line:77,column:48},end:{line:79,column:5}},line:77}},branchMap:{"0":{loc:{start:{line:28,column:4},end:{line:28,column:79}},type:"if",locations:[{start:{line:28,column:4},end:{line:28,column:79}},{start:{line:28,column:4},end:{line:28,column:79}}],line:28},"1":{loc:{start:{line:52,column:4},end:{line:52,column:99}},type:"if",locations:[{start:{line:52,column:4},end:{line:52,column:99}},{start:{line:52,column:4},end:{line:52,column:99}}],line:52},"2":{loc:{start:{line:61,column:4},end:{line:61,column:71}},type:"if",locations:[{start:{line:61,column:4},end:{line:61,column:71}},{start:{line:61,column:4},end:{line:61,column:71}}],line:61},"3":{loc:{start:{line:70,column:4},end:{line:70,column:73}},type:"if",locations:[{start:{line:70,column:4},end:{line:70,column:73}},{start:{line:70,column:4},end:{line:70,column:73}}],line:70},"4":{loc:{start:{line:80,column:4},end:{line:80,column:90}},type:"if",locations:[{start:{line:80,column:4},end:{line:80,column:90}},{start:{line:80,column:4},end:{line:80,column:90}}],line:80}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184"};var coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();cov_1zkuhj9l46.s[0]++;Object.defineProperty(exports,"__esModule",{value:true});var email=(cov_1zkuhj9l46.s[1]++,[{id:1,createdOn:'26/02/2019​',subject:'greetings',message:'How is everything going brother',senderId:2,receiverId:2,parentMessageId:2,status:'sent'},{id:2,createdOn:'26/02/2019​',subject:'greetings',message:'How is everything going brother',senderId:1,receiverId:1,parentMessageId:1,status:'unread'}]);cov_1zkuhj9l46.s[2]++;var getMessages=function getMessages(req,res){cov_1zkuhj9l46.f[0]++;cov_1zkuhj9l46.s[3]++;res.send(email);cov_1zkuhj9l46.s[4]++;if(!getMessages){cov_1zkuhj9l46.b[0][0]++;cov_1zkuhj9l46.s[5]++;res.status(404).send('the data was not found,Try again');}else{cov_1zkuhj9l46.b[0][1]++;}};cov_1zkuhj9l46.s[6]++;var createMessage=function createMessage(req,res){cov_1zkuhj9l46.f[1]++;var newMessage=(cov_1zkuhj9l46.s[7]++,{id:email.length+1,createdOn:new Date(),subject:req.body.subject,message:req.body.message,senderId:req.body.senderId,receivedId:req.body.receivedId,parentMessageId:req.body.parentMessageId,status:req.body.status});cov_1zkuhj9l46.s[8]++;email.push(newMessage);cov_1zkuhj9l46.s[9]++;res.send(newMessage);};cov_1zkuhj9l46.s[10]++;var specificEmail=function specificEmail(req,res){cov_1zkuhj9l46.f[2]++;var specificMessage=(cov_1zkuhj9l46.s[11]++,email.find(function(c){cov_1zkuhj9l46.f[3]++;cov_1zkuhj9l46.s[12]++;return c.id===parseInt(req.params.id);}));cov_1zkuhj9l46.s[13]++;if(!specificMessage){cov_1zkuhj9l46.b[1][0]++;cov_1zkuhj9l46.s[14]++;return res.status(404).send('The Email with the given ID was not found');}else{cov_1zkuhj9l46.b[1][1]++;}cov_1zkuhj9l46.s[15]++;res.status(200).send(specificMessage);};cov_1zkuhj9l46.s[16]++;var sentMessage=function sentMessage(req,res){cov_1zkuhj9l46.f[4]++;var sentEmail=(cov_1zkuhj9l46.s[17]++,email.find(function(c){cov_1zkuhj9l46.f[5]++;cov_1zkuhj9l46.s[18]++;return c.status===req.params.status;}));cov_1zkuhj9l46.s[19]++;if(!sentEmail){cov_1zkuhj9l46.b[2][0]++;cov_1zkuhj9l46.s[20]++;return res.status(400).send('NO any unread Email');}else{cov_1zkuhj9l46.b[2][1]++;}cov_1zkuhj9l46.s[21]++;res.status(200).send(sentEmail);};cov_1zkuhj9l46.s[22]++;var unreadMessage=function unreadMessage(req,res){cov_1zkuhj9l46.f[6]++;var unreadEmail=(cov_1zkuhj9l46.s[23]++,email.find(function(c){cov_1zkuhj9l46.f[7]++;cov_1zkuhj9l46.s[24]++;return c.status===req.params.status;}));cov_1zkuhj9l46.s[25]++;if(!unreadEmail){cov_1zkuhj9l46.b[3][0]++;cov_1zkuhj9l46.s[26]++;return res.status(400).send('NO any unread Email');}else{cov_1zkuhj9l46.b[3][1]++;}cov_1zkuhj9l46.s[27]++;res.status(200).send(unreadEmail);};cov_1zkuhj9l46.s[28]++;var deleteEmail=function deleteEmail(req,res){cov_1zkuhj9l46.f[8]++;var deleteMessage=(cov_1zkuhj9l46.s[29]++,email.find(function(c){cov_1zkuhj9l46.f[9]++;cov_1zkuhj9l46.s[30]++;return c.id===parseInt(req.params.id);}));cov_1zkuhj9l46.s[31]++;if(!deleteMessage){cov_1zkuhj9l46.b[4][0]++;cov_1zkuhj9l46.s[32]++;res.status(404).send('The Email with the given ID was not found');}else{cov_1zkuhj9l46.b[4][1]++;}var index=(cov_1zkuhj9l46.s[33]++,email.indexOf(deleteEmail));cov_1zkuhj9l46.s[34]++;email.splice(index,1);cov_1zkuhj9l46.s[35]++;res.send({deleteMessage:deleteMessage,message:"you deleted email successfully."});};cov_1zkuhj9l46.s[36]++;exports.getMessages=getMessages;cov_1zkuhj9l46.s[37]++;exports.createMessage=createMessage;cov_1zkuhj9l46.s[38]++;exports.specificEmail=specificEmail;cov_1zkuhj9l46.s[39]++;exports.deleteEmail=deleteEmail;cov_1zkuhj9l46.s[40]++;exports.unreadMessage=unreadMessage;cov_1zkuhj9l46.s[41]++;exports.sentMessage=sentMessage;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1lc3NhZ2UuanMiXSwibmFtZXMiOlsiZW1haWwiLCJpZCIsImNyZWF0ZWRPbiIsInN1YmplY3QiLCJtZXNzYWdlIiwic2VuZGVySWQiLCJyZWNlaXZlcklkIiwicGFyZW50TWVzc2FnZUlkIiwic3RhdHVzIiwiZ2V0TWVzc2FnZXMiLCJyZXEiLCJyZXMiLCJzZW5kIiwiY3JlYXRlTWVzc2FnZSIsIm5ld01lc3NhZ2UiLCJsZW5ndGgiLCJEYXRlIiwiYm9keSIsInJlY2VpdmVkSWQiLCJwdXNoIiwic3BlY2lmaWNFbWFpbCIsInNwZWNpZmljTWVzc2FnZSIsImZpbmQiLCJjIiwicGFyc2VJbnQiLCJwYXJhbXMiLCJzZW50TWVzc2FnZSIsInNlbnRFbWFpbCIsInVucmVhZE1lc3NhZ2UiLCJ1bnJlYWRFbWFpbCIsImRlbGV0ZUVtYWlsIiwiZGVsZXRlTWVzc2FnZSIsImluZGV4IiwiaW5kZXhPZiIsInNwbGljZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQ0EsSUFBTUEsUUFBTyxDQUFDO0FBQ1ZDLFFBQUcsQ0FETztBQUVWQyxlQUFVLGFBRkE7QUFHVkMsYUFBUSxXQUhFO0FBSVZDLGFBQVEsaUNBSkU7QUFLVkMsY0FBUyxDQUxDLEVBS0VDLFlBQVcsQ0FMYjtBQU1WQyxxQkFBZ0IsQ0FOTjtBQU9UQyxZQUFPO0FBUEUsQ0FBRCxFQVFYO0FBQ0VQLFFBQUcsQ0FETDtBQUVFQyxlQUFVLGFBRlo7QUFHRUMsYUFBUSxXQUhWO0FBSUVDLGFBQVEsaUNBSlY7QUFLRUMsY0FBUyxDQUxYLEVBS2FDLFlBQVcsQ0FMeEI7QUFNRUMscUJBQWdCLENBTmxCO0FBT0dDLFlBQU87QUFQVixDQVJXLENBQWI7O0FBa0JDLElBQU1DLGNBQWEsU0FBYkEsV0FBYSxDQUFDQyxHQUFELEVBQUtDLEdBQUwsRUFBVzs7QUFFM0JBLFFBQUlDLElBQUosQ0FBU1osS0FBVDtBQUNELFFBQUcsQ0FBQ1MsV0FBSixFQUFpQkUsSUFBSUgsTUFBSixDQUFXLEdBQVgsRUFBZ0JJLElBQWhCLENB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RUFBVDtBQUdILENBVEg7O1FBWUlLLFcsR0FBQUEsVztRQUFZSSxhLEdBQUFBLGE7UUFBY08sYSxHQUFBQSxhO1FBQWNVLFcsR0FBQUEsVztRQUFZRixhLEdBQUFBLGE7UUFBY0YsVyxHQUFBQSxXIiwiZmlsZSI6Im1lc3NhZ2UuanMiLCJzb3VyY2VSb290IjoiQzovVXNlcnMvQWRtaW4vRGVza3RvcC9tYWlsL0VQSUMtTWFpbC9zZXJ2ZXIvY29udHJvbGxlcnMiLCJzb3VyY2VzQ29udGVudCI6WyJcclxuY29uc3QgZW1haWwgPVt7XHJcbiAgICBpZDoxLFxyXG4gICAgY3JlYXRlZE9uOicyNi8wMi8yMDE54oCLJyxcclxuICAgIHN1YmplY3Q6J2dyZWV0aW5ncycsXHJcbiAgICBtZXNzYWdlOidIb3cgaXMgZXZlcnl0aGluZyBnb2luZyBicm90aGVyJyxcclxuICAgIHNlbmRlcklkOjIsIHJlY2VpdmVySWQ6MizCoFxyXG4gICAgcGFyZW50TWVzc2FnZUlkOjIsXHJcbiAgICDCoHN0YXR1czonc2VudCdcclxufSx7XHJcbiAgICBpZDoyLFxyXG4gICAgY3JlYXRlZE9uOicyNi8wMi8yMDE54oCLJyxcclxuICAgIHN1YmplY3Q6J2dyZWV0aW5ncycsXHJcbiAgICBtZXNzYWdlOidIb3cgaXMgZXZlcnl0aGluZyBnb2luZyBicm90aGVyJyxcclxuICAgIHNlbmRlcklkOjEscmVjZWl2ZXJJZDoxLFxyXG4gICAgcGFyZW50TWVzc2FnZUlkOjEsXHJcbiAgICDCoHN0YXR1czondW5yZWFkJ1xyXG4gfV1cclxuXHJcbiBjb25zdCBnZXRNZXNzYWdlcz0gKHJlcSxyZXMpPT57XHJcblxyXG4gICAgcmVzLnNlbmQoZW1haWwpO1xyXG4gICBpZighZ2V0TWVzc2FnZXMpIHJlcy5zdGF0dXMoNDA0KS5zZW5kKCd0aGUgZGF0YSB3YXMgbm90IGZvdW5kLFRyeSBhZ2FpbicpO1xyXG59O1xyXG5cclxuXHJcblxyXG5jb25zdCBjcmVhdGVNZXNzYWdlID0gKHJlcSwgcmVzKSA9PiB7XHJcblxyXG4gICAgY29uc3QgbmV3TWVzc2FnZSA9IHtcclxuICAgICAgICAgICAgaWQ6IGVtYWlsLmxlbmd0aCArIDEsXHJcbiAgICAgICAgICAgIGNyZWF0ZWRPbjpuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICBzdWJqZWN0OiByZXEuYm9keS5zdWJqZWN0LFxyXG4gICAgICAgICAgICBtZXNzYWdlOiByZXEuYm9keS5tZXNzYWdlLFxyXG4gICAgICAgICAgICBzZW5kZXJJZDogcmVxLmJvZHkuc2VuZGVySWQsXHJcbiAgICAgICAgICAgIHJlY2VpdmVkSWQ6IHJlcS5ib2R5LnJlY2VpdmVkSWQsXHJcbiAgICAgICAgICAgIHBhcmVudE1lc3NhZ2VJZDogcmVxLmJvZHkucGFyZW50TWVzc2FnZUlkLFxyXG4gICAgICAgICAgICBzdGF0dXM6IHJlcS5ib2R5LnN0YXR1cyxcclxuICAgICAgICB9O1xyXG4gICAgICAgIGVtYWlsLnB1c2gobmV3TWVzc2FnZSk7XHJcbiAgICAgICAgcmVzLnNlbmQobmV3TWVzc2FnZSk7XHJcbn07XHJcblxyXG5cclxuICBjb25zdCBzcGVjaWZpY0VtYWlsPSAocmVxLHJlcyk9PntcclxuXHJcbiAgIGNvbnN0IHNwZWNpZmljTWVzc2FnZSA9IGVtYWlsLmZpbmQoYyA9PiBjLmlkID09PSBwYXJzZUludCAocmVxLnBhcmFtcy5pZCkpO1xyXG4gICBpZighc3BlY2lmaWNNZXNzYWdlKSByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLnNlbmQoJ1RoZSBFbWFpbCB3aXRoIHRoZSBnaXZlbiBJRCB3YXMgbm90IGZvdW5kJyk7XHJcbiAgIFxyXG4gICByZXMuc3RhdHVzKDIwMCkuc2VuZChzcGVjaWZpY01lc3NhZ2UpO1xyXG4gICAgXHJcbiAgfTtcclxuXHJcblxyXG4gIGNvbnN0IHNlbnRNZXNzYWdlID0gKHJlcSxyZXMpPT57IFxyXG4gICAgY29uc3Qgc2VudEVtYWlsID0gZW1haWwuZmluZChjID0+IGMuc3RhdHVzID09PSByZXEucGFyYW1zLnN0YXR1cyk7XHJcbiAgICBpZighc2VudEVtYWlsKSByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoJ05PIGFueSB1bnJlYWQgRW1haWwnKTtcclxuICAgIHJlcy5zdGF0dXMoMjAwKS5zZW5kKHNlbnRFbWFpbCk7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgXHJcbiAgXHJcbiAgICBjb25zdCB1bnJlYWRNZXNzYWdlID0gKHJlcSxyZXMpPT57XHJcbiAgIFxyXG4gICAgICAgIGNvbnN0IHVucmVhZEVtYWlsID0gZW1haWwuZmluZChjID0+IGMuc3RhdHVzID09PSByZXEucGFyYW1zLnN0YXR1cyk7XHJcbiAgICAgICAgaWYoIXVucmVhZEVtYWlsKSByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoJ05PIGFueSB1bnJlYWQgRW1haWwnKTtcclxuICAgICAgICBcclxuICAgICAgICByZXMuc3RhdHVzKDIwMCkuc2VuZCh1bnJlYWRFbWFpbCk7XHJcbiAgICAgICAgfTtcclxuXHJcblxyXG5cclxuY29uc3QgZGVsZXRlRW1haWwgPSAocmVxLHJlcyk9PntcclxuXHJcbiAgICBjb25zdCBkZWxldGVNZXNzYWdlID0gZW1haWwuZmluZChjID0+IGMuaWQgPT09IHBhcnNlSW50KHJlcS5wYXJhbXMuaWQpKTtcclxuICAgIGlmKCFkZWxldGVNZXNzYWdlKSByZXMuc3RhdHVzKDQwNCkuc2VuZCgnVGhlIEVtYWlsIHdpdGggdGhlIGdpdmVuIElEIHdhcyBub3QgZm91bmQnKTtcclxuICAgIGNvbnN0IGluZGV4ID0gZW1haWwuaW5kZXhPZihkZWxldGVFbWFpbCk7XHJcbiAgICAgIGVtYWlsLnNwbGljZShpbmRleCwxKTsgICBcclxuICAgICAgcmVzLnNlbmQoe2RlbGV0ZU1lc3NhZ2UsbWVzc2FnZTogXCJ5b3UgZGVsZXRlZCBlbWFpbCBzdWNjZXNzZnVsbHkuXCJ9KTtcclxuICBcclxuICBcclxuICB9O1xyXG4gIFxyXG5leHBvcnR7XHJcbiAgICBnZXRNZXNzYWdlcyxjcmVhdGVNZXNzYWdlLHNwZWNpZmljRW1haWwsZGVsZXRlRW1haWwsdW5yZWFkTWVzc2FnZSxzZW50TWVzc2FnZVxyXG59OyAgICJdfQ==